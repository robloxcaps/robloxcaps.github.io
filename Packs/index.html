<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" id="www-roblox-com">
<head>
<title>PACKS</title>
<link rel="icon" href="../img/FaviIcon.ico" type="image/x-icon"> 
<link rel="stylesheet" href="../style.css">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="author" content="OGMelodii & Jakyro"/>
<meta name="description" content="Contains all packs made by OGMelodii & Jakyro."/>
<meta name="keywords" content="Roblox, Retro, Roblox Pack, Sandbox"/>
<meta name="robots" content="all"/>
</head>

<body>

<form name="aspnetForm" method="post" action="default.aspx" id="aspnetForm">
<div id="Container">

    <!-- HEADER SECTION -->
    <div id="Header">
        <div id="Banner">
            <img id="MainBanner" src="../img/2007NoLogoBanner.png" alt="ROBLOX Banner" />
        </div>

        <div id="Navigation">
            <span><a id="ctl00_hlInfo" class="MenuItem" href="/">Info<img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/dist/png/information.png"></a></span>
            <span class="Separator">&nbsp;|&nbsp;</span>
            <span><a id="ctl00_hlPacks" class="MenuItem" href="/Packs/">Packs<img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/package.png"></a></span>
            <span class="Separator">&nbsp;|&nbsp;</span>
            <span><a id="ctl00_hlCredits" class="MenuItem" href="/Credits/">Credits<img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/user.png"></a></span>
            <span class="Separator">&nbsp;|&nbsp;</span>
            <span><a id="ctl00_hlSubmit" class="MenuItem" href="/Submit/">Submit Packs<img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/package_add.png"></a></span>
            <span class="Separator">&nbsp;|&nbsp;</span>
            <span><a id="ctl00_News" class="MenuItem" href="/News/">News<img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/newspaper.png"></a></span>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div id="Body">
        <div id="MainContent">

            <div id="LoadingMessage">Loading packs...</div>

            <div id="ErrorMessage" style="display:none; text-align:center; color:red; padding:20px;">
                Error loading packs.
                <br><br>
                <button onclick="loadPacks()">Retry</button>
            </div>

            <div id="LastUpdated" style="display:none; text-align:center; font-size:12px;">
                Last updated: <span id="UpdateTime"></span>
            </div>

            <div id="PaginationControls" style="display:none; text-align:center; margin-bottom:15px;">
                <button id="prevPage">Previous</button>
                <span id="pageInfo"></span>
                <button id="nextPage">Next</button>
            </div>

            <div class="PackGrid" id="PackGrid" style="display:none;"></div>

        </div>
    </div>

    <!-- FOOTER -->
    <div id="Footer">
        <hr/>
        <p class="Legalese">Â©2026 OGMelodii & Jakyro. All rights reserved.</p>
    </div>

</div>
</form>

<script>
// ============================================
// CONFIGURATION
// ============================================

const GIST_URL = 'https://gist.githubusercontent.com/OGMelodii/5c2f87c5e5020ecd294daba796370a91/raw';
const CACHE_DURATION = 5 * 60 * 1000;
const PACKS_PER_PAGE = 9;

// ============================================
// LOAD
// ============================================

document.addEventListener('DOMContentLoaded', function () {
    loadPacks();
});

function loadPacks() {
    const loading = document.getElementById('LoadingMessage');
    const error = document.getElementById('ErrorMessage');
    const cached = getCachedData();

    loading.style.display = 'block';
    error.style.display = 'none';

    if (cached && !isCacheExpired(cached.timestamp)) {
        displayPacks(cached.packs, cached.timestamp);
        return;
    }

    fetch(GIST_URL + '?t=' + Date.now())
        .then(res => {
            if (!res.ok) throw new Error('Fetch failed');
            return res.json();
        })
        .then(data => {
            cacheData(data.packs);
            displayPacks(data.packs, new Date().toISOString());
        })
        .catch(() => {
            loading.style.display = 'none';
            error.style.display = 'block';
        });
}

// ============================================
// DISPLAY PACKS
// ============================================

function displayPacks(packs, timestamp) {
    const grid = document.getElementById('PackGrid');
    const loading = document.getElementById('LoadingMessage');
    const updated = document.getElementById('LastUpdated');
    const time = document.getElementById('UpdateTime');

    loading.style.display = 'none';
    grid.style.display = 'grid';
    grid.innerHTML = '';

    time.textContent = new Date(timestamp).toLocaleString();
    updated.style.display = 'block';

    packs.slice(0, PACKS_PER_PAGE).forEach(pack => {
        grid.appendChild(createPackItem(pack));
    });
}

// ============================================
// CREATE PACK ITEM (SEE PROFILE INCLUDED)
// ============================================

function createPackItem(pack) {
    const div = document.createElement('div');
    div.className = 'PackItem';

    let iconPath = pack.icon || '../img/Placeholder.png';
    let profileUrl = pack.profileUrl && pack.profileUrl.trim() !== ''
        ? pack.profileUrl
        : null;

    div.innerHTML = `
        <img class="PackIcon"
             src="${iconPath}"
             alt="${escapeHtml(pack.title)} Icon"
             loading="lazy">

        <div class="PackTitle">${escapeHtml(pack.title)}</div>
        <div class="PackAuthor">By: ${escapeHtml(pack.author)}</div>

        <div class="PackCategory" style="font-size:12px; color:#666;">
            Category: ${escapeHtml(pack.category || 'Other')}
        </div>

        <div class="PackVersion" style="font-size:12px; color:#666;">
            Version: ${escapeHtml(pack.version || 'N/A')}
        </div>

        <div class="PackButtons" style="display:flex; gap:5px; margin-top:10px;">

            <a href="${pack.downloadUrl}"
               class="PackDownload"
               target="_blank"
               download
               style="flex:1; text-align:center;">
                <img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/arrow_down.png">
                Download
            </a>

            ${profileUrl ? `
            <a href="${profileUrl}"
               class="PackProfile"
               target="_blank"
               rel="noopener noreferrer"
               style="flex:1; text-align:center; background:var(--primary-color); color:white; border:none; padding:5px; cursor:pointer; text-decoration:none; font-family:'Comic Sans MS','Comic Sans',cursive;">
                <img src="https://raw.githubusercontent.com/legacy-icons/famfamfam-silk/refs/heads/master/src/user.png">
                See Profile
            </a>
            ` : ``}

        </div>
    `;

    return div;
}

// ============================================
// UTILITIES
// ============================================

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function cacheData(packs) {
    localStorage.setItem('packsCache', JSON.stringify({
        packs: packs,
        timestamp: new Date().toISOString()
    }));
}

function getCachedData() {
    const cached = localStorage.getItem('packsCache');
    return cached ? JSON.parse(cached) : null;
}

function isCacheExpired(timestamp) {
    return Date.now() - new Date(timestamp).getTime() > CACHE_DURATION;
}
</script>

</body>
</html>
